<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python-Powered Calculator</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple transition for button clicks */
        .calc-btn {
            transition: background-color 0.1s ease-in-out, transform 0.1s ease-in-out;
        }
        .calc-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-sm mx-auto bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 space-y-6">
        <!-- Display Screen -->
        <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4 text-right">
            <div id="display" class="text-4xl font-semibold text-gray-800 dark:text-gray-100 break-all">0</div>
        </div>

        <!-- Calculator Buttons Grid -->
        <div class="grid grid-cols-4 gap-4">
            <!-- Row 1 -->
            <button onclick="clearDisplay()" class="calc-btn text-2xl bg-red-400 hover:bg-red-500 text-white font-bold py-4 rounded-lg col-span-2">C</button>
            <button onclick="appendCharacter('/')" class="calc-btn text-2xl bg-indigo-400 hover:bg-indigo-500 text-white font-bold py-4 rounded-lg">÷</button>
            <button onclick="appendCharacter('*')" class="calc-btn text-2xl bg-indigo-400 hover:bg-indigo-500 text-white font-bold py-4 rounded-lg">×</button>

            <!-- Row 2 -->
            <button onclick="appendCharacter('7')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">7</button>
            <button onclick="appendCharacter('8')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">8</button>
            <button onclick="appendCharacter('9')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">9</button>
            <button onclick="appendCharacter('-')" class="calc-btn text-2xl bg-indigo-400 hover:bg-indigo-500 text-white font-bold py-4 rounded-lg">−</button>

            <!-- Row 3 -->
            <button onclick="appendCharacter('4')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">4</button>
            <button onclick="appendCharacter('5')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">5</button>
            <button onclick="appendCharacter('6')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">6</button>
            <button onclick="appendCharacter('+')" class="calc-btn text-2xl bg-indigo-400 hover:bg-indigo-500 text-white font-bold py-4 rounded-lg">+</button>

            <!-- Row 4 & 5 -->
            <button onclick="appendCharacter('1')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">1</button>
            <button onclick="appendCharacter('2')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">2</button>
            <button onclick="appendCharacter('3')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">3</button>
            <button onclick="calculate()" class="calc-btn text-2xl bg-green-400 hover:bg-green-500 text-white font-bold py-4 rounded-lg row-span-2">=</button>
            <button onclick="appendCharacter('0')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg col-span-2">0</button>
            <button onclick="appendCharacter('.')" class="calc-btn text-2xl bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 font-bold py-4 rounded-lg">.</button>
        </div>
    </div>

    <script>
        const display = document.getElementById('display');
        let currentExpression = '';

        // Function to add characters to the display
        function appendCharacter(char) {
            if (display.innerText === '0' && !'+-*/'.includes(char)) {
                display.innerText = char;
            } else {
                display.innerText += char;
            }
            currentExpression = display.innerText;
        }

        // Function to clear the display
        function clearDisplay() {
            display.innerText = '0';
            currentExpression = '';
        }

        // Async function to send the expression to the Python backend
        async function calculate() {
            const expression = display.innerText;
            
            // The URL of your Python backend.
            // By default, Flask runs on port 5000.
            const apiUrl = 'http://127.0.0.1:5000/calculate';

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ expression: expression })
                });

                if (!response.ok) {
                    // If the server response is not OK, show an error.
                    const errorData = await response.json();
                    display.innerText = `Error: ${errorData.error || 'Calculation failed'}`;
                    return;
                }

                const resultData = await response.json();
                // Display the result from the backend
                display.innerText = resultData.result;

            } catch (error) {
                // Handle network errors or if the backend is not running.
                console.error('Error:', error);
                display.innerText = 'Error';
            }
        }
    </script>

</body>
</html>
